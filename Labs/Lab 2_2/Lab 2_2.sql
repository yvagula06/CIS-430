USE master;
-- Create a db named COMPANY_yVagula. do NOT use master db.
IF DB_ID('COMPANY_yVagula') IS NULL
CREATE DATABASE COMPANY_yVagula;
GO
-- Use created db
USE COMPANY_yVagula;
GO

-- Drop existing tables if they exist
IF OBJECT_ID('dbo.EMP_Test') IS NOT NULL
DROP TABLE dbo.EMP_Test;
IF OBJECT_ID('dbo.WORKS_ON') IS NOT NULL
DROP TABLE dbo.WORKS_ON;
IF OBJECT_ID('dbo.PROJECT') IS NOT NULL
DROP TABLE dbo.PROJECT;
IF OBJECT_ID('dbo.DEPT_LOCATIONS') IS NOT NULL
DROP TABLE dbo.DEPT_LOCATIONS;
IF OBJECT_ID('dbo.DEPENDENT') IS NOT NULL
DROP TABLE dbo.DEPENDENT;
IF OBJECT_ID('dbo.EMPLOYEE') IS NOT NULL
DROP TABLE dbo.EMPLOYEE;
IF OBJECT_ID('dbo.DEPARTMENT') IS NOT NULL
DROP TABLE dbo.DEPARTMENT;
GO

-- Create the DEPARTMENT table first
CREATE TABLE DEPARTMENT (
    DName VARCHAR(50),
    DNumber INT PRIMARY KEY,
    MgrSSN CHAR(9),
    MgrStartDate DATE
);
GO

-- Create the EMPLOYEE table, which will reference DEPARTMENT
CREATE TABLE EMPLOYEE (
    FName VARCHAR(50),
    MInit CHAR(1),
    LName VARCHAR(50),
    SSN CHAR(9) PRIMARY KEY,
    BDate DATE,
    Address VARCHAR(100),
    Sex CHAR(1),
    Salary DECIMAL(10, 2),
    SuperSSN CHAR(9),
    DNo INT,
    FOREIGN KEY (SuperSSN) REFERENCES EMPLOYEE(SSN),
    FOREIGN KEY (DNo) REFERENCES DEPARTMENT(DNumber)
);
GO

-- Create the DEPT_LOCATIONS table, which will reference DEPARTMENT
CREATE TABLE DEPT_LOCATIONS (
    DNumber INT,
    DLocation VARCHAR(50),
    PRIMARY KEY (DNumber, DLocation),
    FOREIGN KEY (DNumber) REFERENCES DEPARTMENT(DNumber)
);
GO

-- Create the PROJECT table, which will reference DEPARTMENT
CREATE TABLE PROJECT (
    PName VARCHAR(50),
    PNumber INT PRIMARY KEY,
    PLocation VARCHAR(50),
    DNum INT,
    FOREIGN KEY (DNum) REFERENCES DEPARTMENT(DNumber)
);
GO

-- Create the WORKS_ON table, which will reference EMPLOYEE and PROJECT
CREATE TABLE WORKS_ON (
    ESSN CHAR(9),
    PNo INT,
    Hours DECIMAL(3,1),
    PRIMARY KEY (ESSN, PNo),
    FOREIGN KEY (ESSN) REFERENCES EMPLOYEE(SSN),
    FOREIGN KEY (PNo) REFERENCES PROJECT(PNumber)
);
GO

-- Create the DEPENDENT table, which will reference EMPLOYEE
CREATE TABLE DEPENDENT (
    ESSN CHAR(9),
    Dependent_Name VARCHAR(50),
    Sex CHAR(1),
    BDate DATE,
    Relationship VARCHAR(50),
    PRIMARY KEY (ESSN, Dependent_Name),
    FOREIGN KEY (ESSN) REFERENCES EMPLOYEE(SSN)
);
GO

-- Insert data into DEPARTMENT table
INSERT INTO DEPARTMENT VALUES ('Headquarters', 1, '888665555', '1971-06-19');
INSERT INTO DEPARTMENT VALUES ('Administration', 4, '987654321', '1985-01-01');
INSERT INTO DEPARTMENT VALUES ('Research', 5, '333445555', '1978-05-22');
INSERT INTO DEPARTMENT VALUES ('Automation', 7, '123456789', '2005-10-06');
GO

-- Insert data into EMPLOYEE table
INSERT INTO EMPLOYEE VALUES ('John', 'B', 'Smith', '123456789', '1955-01-09', '731 Fondren, Houston, TX', 'M', 30000, '987654321', 5);
INSERT INTO EMPLOYEE VALUES ('Franklin', 'T', 'Wong', '333445555', '1945-12-08', '638 Voss, Houston, TX', 'M', 40000, '888665555', 5);
INSERT INTO EMPLOYEE VALUES ('Joyce', 'A', 'English', '453453453', '1962-07-31', '5631 Rice, Houston, TX', 'F', 25000, '333445555', 5);
INSERT INTO EMPLOYEE VALUES ('Ramesh', 'K', 'Narayan', '666884444', '1952-09-15', '975 Fire Oak, Humble, TX', 'M', 38000, '333445555', 5);
INSERT INTO EMPLOYEE VALUES ('James', 'E', 'Borg', '888665555', '1927-11-10', '450 Stone, Houston, TX', 'M', 55000, NULL, 1);
INSERT INTO EMPLOYEE VALUES ('Jennifer', 'S', 'Wallace', '987654321', '1931-06-20', '291 Berry, Bellaire, TX', 'F', 43000, '888665555', 4);
INSERT INTO EMPLOYEE VALUES ('Ahmad', 'V', 'Jabbar', '987987987', '1959-03-29', '980 Dallas, Houston, TX', 'M', 25000, '987654321', 4);
INSERT INTO EMPLOYEE VALUES ('Alicia', 'J', 'Zelaya', '999887777', '1958-07-19', '3321 Castle, Spring, TX', 'F', 25000, '987654321', 4);
GO

-- Insert data into DEPENDENT table
INSERT INTO DEPENDENT VALUES ('123456789', 'Alice', 'F', '1978-12-31', 'Daughter');
INSERT INTO DEPENDENT VALUES ('123456789', 'Elizabeth', 'F', '1957-05-05', 'Spouse');
INSERT INTO DEPENDENT VALUES ('123456789', 'Michael', 'M', '1978-01-01', 'Son');
INSERT INTO DEPENDENT VALUES ('333445555', 'Alice', 'F', '1976-04-05', 'Daughter');
INSERT INTO DEPENDENT VALUES ('333445555', 'Joy', 'F', '1948-05-03', 'Spouse');
INSERT INTO DEPENDENT VALUES ('333445555', 'Theodore', 'M', '1973-10-25', 'Son');
INSERT INTO DEPENDENT VALUES ('987654321', 'Abner', 'M', '1932-02-29', 'Spouse');
GO

-- Insert data into DEPT_LOCATIONS table
INSERT INTO DEPT_LOCATIONS VALUES (1, 'Houston');
INSERT INTO DEPT_LOCATIONS VALUES (4, 'Stafford');
INSERT INTO DEPT_LOCATIONS VALUES (5, 'Bellaire');
INSERT INTO DEPT_LOCATIONS VALUES (5, 'Sugarland');
INSERT INTO DEPT_LOCATIONS VALUES (5, 'Houston');
GO

-- Insert data into PROJECT table
INSERT INTO PROJECT VALUES ('ProductX', 1, 'Bellaire', 5);
INSERT INTO PROJECT VALUES ('ProductY', 2, 'Sugarland', 5);
INSERT INTO PROJECT VALUES ('ProductZ', 3, 'Houston', 5);
INSERT INTO PROJECT VALUES ('Computerization', 10, 'Stafford', 4);
INSERT INTO PROJECT VALUES ('Reorganization', 20, 'Houston', 1);
INSERT INTO PROJECT VALUES ('Newbenefits', 30, 'Stafford', 4);
GO

-- Insert data into WORKS_ON table
INSERT INTO WORKS_ON VALUES ('123456789', 1, 32.5);
INSERT INTO WORKS_ON VALUES ('123456789', 2, 7.5);
INSERT INTO WORKS_ON VALUES ('333445555', 2, 10);
INSERT INTO WORKS_ON VALUES ('333445555', 3, 10);
INSERT INTO WORKS_ON VALUES ('333445555', 10, 10);
INSERT INTO WORKS_ON VALUES ('333445555', 20, 10);
INSERT INTO WORKS_ON VALUES ('453453453', 1, 20);
INSERT INTO WORKS_ON VALUES ('453453453', 2, 20);
INSERT INTO WORKS_ON VALUES ('666884444', 3, 40);
INSERT INTO WORKS_ON VALUES ('888665555', 20, NULL);
INSERT INTO WORKS_ON VALUES ('987654321', 20, 15);
INSERT INTO WORKS_ON VALUES ('987654321', 30, 20);
INSERT INTO WORKS_ON VALUES ('987987987', 10, 35);
INSERT INTO WORKS_ON VALUES ('987987987', 30, 5);
INSERT INTO WORKS_ON VALUES ('999887777', 10, 10);
INSERT INTO WORKS_ON VALUES ('999887777', 30, 30);
GO

-- Print the tables
SELECT * FROM EMPLOYEE;
SELECT * FROM DEPARTMENT;
SELECT * FROM WORKS_ON;
SELECT * FROM DEPENDENT;
SELECT * FROM DEPT_LOCATIONS;
SELECT * FROM PROJECT;
